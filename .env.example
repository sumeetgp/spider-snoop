# =============================================================================
# SPIDER-SNOOP DLP SYSTEM - ENVIRONMENT CONFIGURATION
# =============================================================================
# Copy this file to .env and fill in your actual values
# Never commit .env to version control (it's in .gitignore)
# =============================================================================

# -----------------------------------------------------------------------------
# APPLICATION SETTINGS
# -----------------------------------------------------------------------------
# Application name displayed in API docs and logs
APP_NAME="Spider-Snoop DLP"

# Application version
APP_VERSION="1.0.0"

# Enable debug mode (set to "true" for development, "false" for production)
# In debug mode, auto-reload is enabled and detailed error messages are shown
DEBUG=true

# Logging level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# -----------------------------------------------------------------------------
# DATABASE CONFIGURATION
# -----------------------------------------------------------------------------
# SQLite database URL (default for local development)
# For production, use PostgreSQL: postgresql://user:password@localhost/dbname
DATABASE_URL=sqlite:///./dlp_data.db

# -----------------------------------------------------------------------------
# SECURITY & AUTHENTICATION
# -----------------------------------------------------------------------------
# Secret key for JWT token signing (MUST be changed in production!)
# Generate a secure key: openssl rand -hex 32
SECRET_KEY=your-super-secret-key-change-this-in-production-use-openssl-rand-hex-32

# JWT algorithm for token encoding/decoding
ALGORITHM=HS256

# JWT token expiration time in minutes
ACCESS_TOKEN_EXPIRE_MINUTES=30

# -----------------------------------------------------------------------------
# ICAP SERVER CONFIGURATION
# -----------------------------------------------------------------------------
# ICAP server host (0.0.0.0 allows connections from any network interface)
ICAP_HOST=0.0.0.0

# ICAP server port (standard ICAP port is 1344)

# -----------------------------------------------------------------------------
# AI/ML CONFIGURATION
# -----------------------------------------------------------------------------
# OpenAI API key for AI-powered DLP scanning and LangChain agent
# Get your key from: https://platform.openai.com/api-keys
# IMPORTANT: Never commit this key to version control!
OPENAI_API_KEY=sk-proj-your-openai-api-key-here

ICAP_PORT=1344

# ICAP service name used in ICAP URLs (icap://host:port/SERVICE_NAME)
ICAP_SERVICE_NAME=dlp_scan

# -----------------------------------------------------------------------------
# AI & LANGCHAIN CONFIGURATION
# -----------------------------------------------------------------------------
# OpenAI API Key for AI-powered DLP analysis
# Get your key from: https://platform.openai.com/api-keys
# REQUIRED for AI features to work
OPENAI_API_KEY=sk-proj-your-openai-api-key-here


# Enable LangChain-based CISO agent (true/false)
# When true: Uses advanced LangChain ReAct agent with MCP pattern scanner tool
# When false: Uses simple OpenAI chat completion for AI analysis
# Default: false
USE_LANGCHAIN_CISO=false

# OpenAI model to use for LangChain agent
# Options: gpt-4o-mini, gpt-4o, gpt-4-turbo, gpt-3.5-turbo
# Default: gpt-4o-mini (recommended for cost/performance balance)
OPENAI_MODEL=gpt-4o-mini

# Temperature for LLM responses (0.0-1.0)
# 0.0 = deterministic, 1.0 = creative
# For security analysis, recommend keeping it low (0.0-0.3)
OPENAI_TEMPERATURE=0.0

# -----------------------------------------------------------------------------
# FASTAPI SERVER CONFIGURATION
# -----------------------------------------------------------------------------
# FastAPI server host
API_HOST=0.0.0.0

# FastAPI server port
API_PORT=8000

# Enable CORS (Cross-Origin Resource Sharing)
# Set to comma-separated origins in production, e.g., "https://example.com,https://app.example.com"
# Use "*" for development to allow all origins
CORS_ORIGINS=*

# -----------------------------------------------------------------------------
# MCP (Model Context Protocol) CONFIGURATION
# -----------------------------------------------------------------------------
# MCP Server command (for pattern scanning tool)
# Default uses the dlp_server.py with uv runner
MCP_SERVER_COMMAND=uv

# MCP Server arguments
# Default: run dlp_server.py
MCP_SERVER_ARGS=run,dlp_server.py

# -----------------------------------------------------------------------------
# DLP SCANNING CONFIGURATION
# -----------------------------------------------------------------------------
# Enable AI-based scanning by default (true/false)
# When true, AI analysis is performed in addition to pattern matching
# When false, only regex pattern matching is used
USE_AI_SCAN=true

# Maximum file size for scanning (in bytes)
# Files larger than this will be truncated
# Default: 20000 bytes (~20KB) to prevent high API costs
MAX_SCAN_SIZE=20000

# -----------------------------------------------------------------------------
# EXAMPLE USERS (FOR INITIAL DATABASE SETUP)
# -----------------------------------------------------------------------------
# These are created by scripts/init_db.py
# Default Admin Credentials
ADMIN_USERNAME=admin
ADMIN_PASSWORD=admin123

# Default Analyst Credentials
ANALYST_USERNAME=analyst
ANALYST_PASSWORD=analyst123

# Default Viewer Credentials
VIEWER_USERNAME=viewer
VIEWER_PASSWORD=viewer123

# =============================================================================
# NOTES:
# - Never commit actual API keys or secrets to version control
# - Use .env for local development only
# - For production, use proper secrets management (AWS Secrets Manager, etc.)
# - Rotate credentials regularly
# - Use strong, unique passwords for all accounts
# =============================================================================
